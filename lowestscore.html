<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="score.css">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤</title>
</head>
<body>
  <div class="wrap">

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ã‡πâ‡∏≤‡∏¢: ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
    <div class="panel" id="formPanel">
      <header class="app-head">
        <div class="logo">A+</div>
        <div>
          <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h1>
          <p>‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ì‡∏∞ ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏ú‡∏ô‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
        </div>
      </header>

      <!-- Section 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
      <div class="section" id="basicSection">
        <h3>üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h3>
        <div style="margin-top:8px">
          <label class="field-label">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
          <select id="levelSelect" aria-label="levelSelect">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ --</option>
            <option value="‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 1">‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 1</option>
            <option value="‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 2">‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 2</option>
            <option value="‡∏°.5 ‡πÄ‡∏ó‡∏≠‡∏° 1">‡∏°.5 ‡πÄ‡∏ó‡∏≠‡∏° 1</option>
            <option value="‡∏°.5 ‡πÄ‡∏ó‡∏≠‡∏° 2">‡∏°.5 ‡πÄ‡∏ó‡∏≠‡∏° 2</option>
            <option value="‡∏°.6 ‡πÄ‡∏ó‡∏≠‡∏° 1">‡∏°.6 ‡πÄ‡∏ó‡∏≠‡∏° 1</option>
          </select>
        </div>

        <div style="margin-top:10px">
          <label class="field-label">‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
          <select id="planSelect" aria-label="planSelect">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
            <option value="sci-math">‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‚Äì ‡∏Ñ‡∏ì‡∏¥‡∏ï</option>
            <option value="sci-ai">‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‚Äì AI</option>
            <option value="arts-math">‡∏®‡∏¥‡∏•‡∏õ‡πå ‚Äì ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</option>
            <option value="arts-japan">‡∏®‡∏¥‡∏•‡∏õ‡πå ‚Äì ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</option>
            <option value="arts-chinese">‡∏®‡∏¥‡∏•‡∏õ‡πå ‚Äì ‡∏à‡∏µ‡∏ô</option>
            <option value="arts-french">‡∏®‡∏¥‡∏•‡∏õ‡πå ‚Äì ‡∏ù‡∏£‡∏±‡πà‡∏á‡πÄ‡∏®‡∏™</option>
            <option value="homeeco">‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏°</option>
          </select>
        </div>
      </div>

      <!-- Section 2: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£ -->
      <div class="section" id="roundSection">
        <h3>üéØ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≠‡∏ö)</h3>
        <div class="selection-grid" id="roundGrid" aria-label="roundGrid">
          <div class="card" data-round="portfolio" title="Portfolio ‚Äî ‡πÉ‡∏ä‡πâ‡πÅ‡∏ü‡πâ‡∏°‡∏™‡∏∞‡∏™‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô">
            ‡∏£‡∏≠‡∏ö 1: Portfolio
            <span class="meta">‡∏ú‡∏•‡∏á‡∏≤‡∏ô / ‡∏û‡∏≠‡∏£‡πå‡∏ï</span>
          </div>
          <div class="card" data-round="quota" title="Quota ‚Äî ‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤">
            ‡∏£‡∏≠‡∏ö 2: ‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤
            <span class="meta">‡πÄ‡∏Å‡∏£‡∏î+‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</span>
          </div>
          <div class="card" data-round="admission" title="Admission ‚Äî ‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏£‡∏î">
            ‡∏£‡∏≠‡∏ö 3: Admission
            <span class="meta">‡∏™‡∏≠‡∏ö + ‡πÄ‡∏Å‡∏£‡∏î</span>
          </div>
        </div>
      </div>

      <!-- Section 3: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ì‡∏∞‡πÅ‡∏•‡∏∞‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ -->
      <div class="section" id="selectSection">
        <h3>üè´ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ì‡∏∞‡πÅ‡∏•‡∏∞‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢</h3>

        <div style="margin-top:8px">
          <label class="field-label">‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ì‡∏∞)</label>
          <!-- Grid ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -->
          <div class="selection-grid" id="fieldGrid" aria-label="fieldGrid"></div>
        </div>

        <div style="margin-top:12px">
          <label class="field-label">‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏´‡πà‡∏á)</label>
          <!-- Grid ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
          <div class="selection-grid" id="universityGrid" aria-label="universityGrid"></div>
        </div>
      </div>

      <!-- Section 4: ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î -->
      <div class="section" id="gradeSection">
        <h3>üìä ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</h3>
        <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏Å‡∏£‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡πÑ‡∏î‡∏ô‡∏≤‡∏°‡∏¥‡∏Å‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
        <div id="gradeForm" class="grade-area">
          <div class="muted">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
        </div>
      </div>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ -->
      <div class="btn-row" style="justify-content:flex-end">
        <button id="resetBtn" class="btn ghost" title="‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        <button id="calculateBtn" class="btn primary" disabled>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤</button>
      </div>

      <!-- ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
      <div style="margin-top:12px" class="muted small">
        <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≠‡∏ö/‡∏´‡∏•‡∏≤‡∏¢‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏≠‡∏Å‡∏≤‡∏™
      </div>
    </div>

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏ß‡∏≤: ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô -->
    <div class="results-panel" id="resultsPanel">
      <div class="result-card fade-in" id="resultSummary">
        <h3>üìà ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì)</h3>
        <p class="muted">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏î "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤" ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
      </div>
      <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î -->
      <div id="resultContent"></div>
    </div>
  </div>

  <script>

  // ========== ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å (Master Data) ==========

  // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
  const levels = [
    '‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 1', '‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 2', '‡∏°.5 ‡πÄ‡∏ó‡∏≠‡∏° 1', '‡∏°.5 ‡πÄ‡∏ó‡∏≠‡∏° 2', '‡∏°.6 ‡πÄ‡∏ó‡∏≠‡∏° 1'
  ];

  // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
  const plans = {
    'sci-math': '‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‚Äì ‡∏Ñ‡∏ì‡∏¥‡∏ï',
    'sci-ai': '‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‚Äì AI',
    'arts-math': '‡∏®‡∏¥‡∏•‡∏õ‡πå ‚Äì ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì',
    'arts-japan': '‡∏®‡∏¥‡∏•‡∏õ‡πå ‚Äì ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô',
    'arts-chinese': '‡∏®‡∏¥‡∏•‡∏õ‡πå ‚Äì ‡∏à‡∏µ‡∏ô',
    'arts-french': '‡∏®‡∏¥‡∏•‡∏õ‡πå ‚Äì ‡∏ù‡∏£‡∏±‡πà‡∏á‡πÄ‡∏®‡∏™',
    'homeeco': '‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏°'
  };

  // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢
  const universities = [
    '‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏°‡∏´‡∏¥‡∏î‡∏•',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ò‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏™‡∏á‡∏Ç‡∏•‡∏≤‡∏ô‡∏Ñ‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏®‡∏£‡∏µ‡∏ô‡∏Ñ‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡∏ß‡∏¥‡πÇ‡∏£‡∏í',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏£‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏´‡∏á',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏û‡∏£‡∏∞‡∏à‡∏≠‡∏°‡πÄ‡∏Å‡∏•‡πâ‡∏≤‡∏ò‡∏ô‡∏ö‡∏∏‡∏£‡∏µ',
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏û‡∏£‡∏∞‡∏à‡∏≠‡∏°‡πÄ‡∏Å‡∏•‡πâ‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏´‡∏≤‡∏£‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á'
  ];

  // ‡∏Ñ‡∏ì‡∏∞/‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
  const fieldOptions = {
    'sci-math': [
      { id: 'med', name: '‡πÅ‡∏û‡∏ó‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'dent', name: '‡∏ó‡∏±‡∏ô‡∏ï‡πÅ‡∏û‡∏ó‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'pharma', name: '‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'engineer', name: '‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'sci', name: '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' }
    ],
    'sci-ai': [
      { id: 'engineer', name: '‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'ai', name: '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå (AI)' },
      { id: 'it', name: '‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®' },
      { id: 'sci', name: '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' }
    ],
    'arts-math': [
      { id: 'biz', name: '‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ' },
      { id: 'econ', name: '‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'satis', name: '‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå' },
      { id: 'social', name: '‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' }
    ],
    'arts-japan': [
      { id: 'lang', name: '‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'human', name: '‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'art', name: '‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'teach', name: '‡∏®‡∏∂‡∏Å‡∏©‡∏≤/‡∏Ñ‡∏£‡∏∏‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'hotel', name: '‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°' }
    ],
    'arts-chinese': [
      { id: 'lang', name: '‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'human', name: '‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'art', name: '‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'teach', name: '‡∏®‡∏∂‡∏Å‡∏©‡∏≤/‡∏Ñ‡∏£‡∏∏‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'hotel', name: '‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°' }
    ],
    'arts-french': [
      { id: 'lang', name: '‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'human', name: '‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'art', name: '‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'teach', name: '‡∏®‡∏∂‡∏Å‡∏©‡∏≤/‡∏Ñ‡∏£‡∏∏‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'hotel', name: '‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°' }
    ],
    'homeeco': [
      { id: 'homeeco1', name: '‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå' },
      { id: 'homeeco2', name: '‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£' }
    ]
  };

  // ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ì‡∏∞
  const gradeRequirements = {
    med: {
      GPAX: 3.5,                    // ‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏Ñ‡∏°‡∏µ', '‡∏ä‡∏µ‡∏ß‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤'], // ‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
      subMin: 3.25,                 // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
      baseChance: { portfolio: 15, quota: 25, admission: 35 } // ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö
    },
    dent: {
      GPAX: 3.3,
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏Ñ‡∏°‡∏µ', '‡∏ä‡∏µ‡∏ß‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤'],
      subMin: 3.0,
      baseChance: { portfolio: 20, quota: 30, admission: 40 }
    },
    pharma: {
      GPAX: 3.3,
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏Ñ‡∏°‡∏µ'],
      subMin: 2.75,
      baseChance: { portfolio: 25, quota: 35, admission: 45 }
    },
    engineer: {
      GPAX: 3.0,
      subjects: ['‡∏Ñ‡¶£‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏Ñ‡∏°‡∏µ'],
      subMin: 2.75,
      baseChance: { portfolio: 30, quota: 40, admission: 50 }
    },
    sci: {
      GPAX: 2.8,
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå'],
      subMin: 2.5,
      baseChance: { portfolio: 40, quota: 50, admission: 60 }
    },
    ai: {
      GPAX: 3.0,
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå'],
      subMin: 2.75,
      baseChance: { portfolio: 35, quota: 45, admission: 55 }
    },
    it: {
      GPAX: 2.75,
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå'],
      subMin: 2.5,
      baseChance: { portfolio: 40, quota: 50, admission: 60 }
    },
    biz: {
      GPAX: 3.0,
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©'],
      subMin: 2.75,
      baseChance: { portfolio: 35, quota: 45, admission: 55 }
    },
    econ: {
      GPAX: 2.75,
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©'],
      subMin: { '‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': 2.5, '‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©': 2.75 }, // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤
      baseChance: { portfolio: 40, quota: 50, admission: 60 }
    },
    satis: {
      GPAX: 2.5,
      subjects: ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå'],
      subMin: 2.25,
      baseChance: { portfolio: 45, quota: 55, admission: 65 }
    },
    social: {
      GPAX: 2.5,
      subjects: ['‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', '‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢'],
      subMin: 2.25,
      baseChance: { portfolio: 45, quota: 55, admission: 65 }
    },
    lang: {
      GPAX: 2.8,
      subjects: ['‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©', '‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®'],
      subMin: 2.5,
      baseChance: { portfolio: 40, quota: 50, admission: 60 }
    },
    human: {
      GPAX: 2.75,
      subjects: ['‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©', '‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢'],
      subMin: 2.25,
      baseChance: { portfolio: 40, quota: 50, admission: 60 }
    },
    art: {
      GPAX: 2.75,
      subjects: ['‡∏®‡∏¥‡∏•‡∏õ‡∏∞'],
      subMin: 2.25,
      baseChance: { portfolio: 50, quota: 60, admission: 70 }
    },
    teach: {
      GPAX: 2.5,
      subjects: ['‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢', '‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©'],
      subMin: 2.25,
      baseChance: { portfolio: 45, quota: 55, admission: 65 }
    },
    hotel: {
      GPAX: 2.5,
      subjects: ['‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©'],
      subMin: 2.25,
      baseChance: { portfolio: 50, quota: 60, admission: 70 }
    },
    homeeco1: {
      GPAX: 2.25,
      subjects: ['‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏°'],
      subMin: 2.0,
      baseChance: { portfolio: 55, quota: 65, admission: 75 }
    },
    homeeco2: {
      GPAX: 2.5,
      subjects: ['‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏°'],
      subMin: 2.25,
      baseChance: { portfolio: 50, quota: 60, admission: 70 }
    }
  };

  // ‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ (‡∏¢‡∏¥‡πà‡∏á‡∏ô‡πâ‡∏≠‡∏¢ = ‡∏¢‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô)
  const universityMultiplier = {
    '‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢': 0.7,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏°‡∏´‡∏¥‡∏î‡∏•': 0.75,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ò‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': 0.8,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': 0.85,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà': 0.9,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô': 0.95,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏™‡∏á‡∏Ç‡∏•‡∏≤‡∏ô‡∏Ñ‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå': 0.95,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏®‡∏£‡∏µ‡∏ô‡∏Ñ‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡∏ß‡∏¥‡πÇ‡∏£‡∏í': 1.0,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏£‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏´‡∏á': 1.1,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏û‡∏£‡∏∞‡∏à‡∏≠‡∏°‡πÄ‡∏Å‡∏•‡πâ‡∏≤‡∏ò‡∏ô‡∏ö‡∏∏‡∏£‡∏µ': 0.85,
    '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏û‡∏£‡∏∞‡∏à‡∏≠‡∏°‡πÄ‡∏Å‡∏•‡πâ‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏´‡∏≤‡∏£‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á': 0.85
  };

  // ========== ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏•‡∏±‡∏Å ==========

  // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å
  let selectedData = {
    level: '',              // ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
    plan: '',               // ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
    rounds: [],             // ‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    fields: [],             // ‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    universities: [],       // ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    pastGrades: {},         // ‡πÄ‡∏Å‡∏£‡∏î‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ö‡∏ö { '‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 1': { '‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': 3.5, ... }, ... }
    pastTermGPA: {}         // ‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏ó‡∏≠‡∏° ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ö‡∏ö { '‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 1': 3.2, ... }
  };

  // ========== ‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á DOM Elements ==========

  const el = {
    levelSelect: document.getElementById('levelSelect'),
    planSelect: document.getElementById('planSelect'),
    roundGrid: document.getElementById('roundGrid'),
    fieldGrid: document.getElementById('fieldGrid'),
    universityGrid: document.getElementById('universityGrid'),
    gradeForm: document.getElementById('gradeForm'),
    calculateBtn: document.getElementById('calculateBtn'),
    resetBtn: document.getElementById('resetBtn'),
    resultContent: document.getElementById('resultContent'),
    resultSummary: document.getElementById('resultSummary'),
    resultsPanel: document.getElementById('resultsPanel')
  };

  // ========== Utility Functions ==========

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
  function qs(selector, root = document) { return root.querySelector(selector); }
  function qsa(selector, root = document) { return Array.from(root.querySelectorAll(selector)); }
  function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); } // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á a-b
  function toNum(v){ const n = parseFloat(v); return isNaN(n) ? null : Math.round(n*100)/100; } // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 2 ‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°

  // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
  function showNotice(msg, timeout=2400){
    const d = document.createElement('div');
    d.textContent = msg;
    d.style.position = 'fixed';
    d.style.right = '22px';
    d.style.bottom = '22px';
    d.style.padding = '10px 14px';
    d.style.background = 'linear-gradient(90deg,var(--accent),#764ba2)';
    d.style.color = 'white';
    d.style.borderRadius = '10px';
    d.style.boxShadow = '0 12px 30px rgba(102,126,234,0.16)';
    d.style.zIndex = 9999;
    d.style.fontSize = '14px';
    document.body.appendChild(d);
    setTimeout(()=> d.style.opacity = '0', timeout-300);
    setTimeout(()=> d.remove(), timeout);
  }

  // ========== ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á UI ‡πÅ‡∏ö‡∏ö‡πÑ‡∏î‡∏ô‡∏≤‡∏°‡∏¥‡∏Å ==========

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á Grid ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ì‡∏∞‡πÅ‡∏•‡∏∞‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢
  function initSelectionGrids(){
    renderUniversityGrid();
    renderFieldGrid(); 
  }

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Grid ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢
  function renderUniversityGrid(){
    const container = el.universityGrid;
    container.innerHTML = '';
    universities.forEach(u => {
      const card = document.createElement('div');
      card.className = 'card';
      card.textContent = u;
      card.dataset.uni = u;
      
      // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å
      card.innerHTML += `<div class="meta">‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì: ${universityMultiplier[u]||1.0}</div>`;
      
      // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
      card.addEventListener('click', () => {
        card.classList.toggle('selected');
        const name = card.dataset.uni;
        if(card.classList.contains('selected')){
          if(!selectedData.universities.includes(name)) selectedData.universities.push(name);
        } else {
          selectedData.universities = selectedData.universities.filter(x => x !== name);
        }
        checkCalculateButton(); // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
      });
      container.appendChild(card);
    });
  }

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Grid ‡∏Ñ‡∏ì‡∏∞ (‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)
  function renderFieldGrid(){
    const container = el.fieldGrid;
    container.innerHTML = '';
    
    if(!selectedData.plan){
      // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
      Object.keys(plans).forEach(k => {
        const c=document.createElement('div');
        c.className='card';
        c.textContent = plans[k];
        c.title='‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á';
        container.appendChild(c);
      });
      return;
    }
    
    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ì‡∏∞‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    const list = fieldOptions[selectedData.plan] || [];
    list.forEach(field => {
      const card = document.createElement('div');
      card.className = 'card';
      card.textContent = field.name;
      card.dataset.field = field.id;
      
      card.addEventListener('click', ()=>{
        card.classList.toggle('selected');
        const id = card.dataset.field;
        if(card.classList.contains('selected')){
          if(!selectedData.fields.includes(id)) selectedData.fields.push(id);
        } else {
          selectedData.fields = selectedData.fields.filter(f => f !== id);
        }
        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ì‡∏∞‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏Å‡∏£‡∏î‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
        loadGradeForm();
        checkCalculateButton();
      });
      container.appendChild(card);
    });
  }

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡πÅ‡∏ö‡∏ö‡πÑ‡∏î‡∏ô‡∏≤‡∏°‡∏¥‡∏Å
  function loadGradeForm(){
    const container = el.gradeForm;
    container.innerHTML = '';

    if(!selectedData.level || !selectedData.plan){
      container.innerHTML = '<div class="muted">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î</div>';
      return;
    }

    // ‡∏´‡∏≤‡πÄ‡∏ó‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î
    const idx = levels.indexOf(selectedData.level);
    const prevTerms = idx > 0 ? levels.slice(0, idx) : [];

    // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    let allSubjects = new Set();
    if(selectedData.fields.length > 0){
      selectedData.fields.forEach(fid => {
        const req = gradeRequirements[fid];
        if(req && Array.isArray(req.subjects)){
          req.subjects.forEach(s => allSubjects.add(s));
        }
      });
    }
    
    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
    if(allSubjects.size === 0){
      if(selectedData.plan.startsWith('sci')){
        ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå','‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå','‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå','‡πÄ‡∏Ñ‡∏°‡∏µ'].forEach(s=>allSubjects.add(s));
      } else if (selectedData.plan.startsWith('arts')){
        ['‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå','‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©','‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢'].forEach(s=>allSubjects.add(s));
      } else {
        allSubjects.add('‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏°');
      }
    }

    const subjectsArray = Array.from(allSubjects);

    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ó‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô ‡∏°.4 ‡πÄ‡∏ó‡∏≠‡∏° 1)
    if(prevTerms.length === 0){
      const note = document.createElement('div');
      note.className = 'muted';
      note.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ó‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ';
      container.appendChild(note);
      
      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      const currentCard = document.createElement('div');
      currentCard.className = 'term-card';
      currentCard.innerHTML = `<h4>üìù ‡πÄ‡∏Å‡∏£‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h4>`;
      
      const gpaRow = document.createElement('div');
      gpaRow.className = 'subject-row';
      const gpaLabel = document.createElement('label');
      gpaLabel.textContent = '‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏ß‡∏° (GPA)';
      const gpaInput = document.createElement('input');
      gpaInput.type='number';
      gpaInput.min='0'; gpaInput.max='4'; gpaInput.step='0.01'; gpaInput.placeholder='0.00-4.00';
      gpaInput.value = selectedData.pastTermGPA['current'] || '';
      gpaInput.addEventListener('change', () => {
        const v = toNum(gpaInput.value);
        if(v === null){ delete selectedData.pastTermGPA['current']; }
        else { selectedData.pastTermGPA['current'] = clamp(v,0,4); }
        checkCalculateButton();
      });
      gpaRow.appendChild(gpaLabel);
      gpaRow.appendChild(gpaInput);
      currentCard.appendChild(gpaRow);
      container.appendChild(currentCard);
      return;
    }

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏ó‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
    prevTerms.forEach(term => {
      const card = document.createElement('div');
      card.className = 'term-card';
      card.dataset.term = term;
      card.innerHTML = `<h4>üìù ${term}</h4>`;
      
      // ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å GPA ‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏ó‡∏≠‡∏°
      const gpaRow = document.createElement('div'); gpaRow.className = 'subject-row';
      const gpaLabel = document.createElement('label'); gpaLabel.textContent = '‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏ß‡∏° (GPA)';
      const gpaInput = document.createElement('input'); gpaInput.type='number'; gpaInput.min='0'; gpaInput.max='4'; gpaInput.step='0.01';
      gpaInput.placeholder = '0.00-4.00';
      if(selectedData.pastTermGPA[term]) gpaInput.value = selectedData.pastTermGPA[term];
      gpaInput.addEventListener('change', () => {
        const v = toNum(gpaInput.value);
        if(v === null) delete selectedData.pastTermGPA[term];
        else selectedData.pastTermGPA[term] = clamp(v,0,4);
        checkCalculateButton();
      });
      gpaRow.appendChild(gpaLabel); gpaRow.appendChild(gpaInput);
      card.appendChild(gpaRow);

      // ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤
      subjectsArray.forEach(subject => {
        const srow = document.createElement('div'); srow.className = 'subject-row';
        const slabel = document.createElement('label'); slabel.textContent = subject;
        const sinput = document.createElement('input'); sinput.type='number'; sinput.min='0'; sinput.max='4'; sinput.step='0.01';
        sinput.placeholder = '0.00-4.00';
        
        // ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
        if(selectedData.pastGrades[term] && selectedData.pastGrades[term][subject] !== undefined){
          sinput.value = selectedData.pastGrades[term][subject];
        }
        
        sinput.addEventListener('change', ()=>{
          const v = toNum(sinput.value);
          if(v === null){
            if(selectedData.pastGrades[term]) delete selectedData.pastGrades[term][subject];
          } else {
            if(!selectedData.pastGrades[term]) selectedData.pastGrades[term] = {};
            selectedData.pastGrades[term][subject] = clamp(v,0,4);
          }
          checkCalculateButton();
        });
        srow.appendChild(slabel); srow.appendChild(sinput);
        card.appendChild(srow);
      });

      container.appendChild(card);
    });
  } 

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
  function checkCalculateButton(){
    const btn = el.calculateBtn;
    const hasBasic = selectedData.level && selectedData.plan;
    const hasSelections = selectedData.rounds.length > 0 && selectedData.fields.length > 0 && selectedData.universities.length > 0;

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÄ‡∏Å‡∏£‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    const idx = levels.indexOf(selectedData.level);
    const needGrades = idx > 0;
    let hasGrades = true;
    if(needGrades){
      // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏£‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß
      const gpaxCount = Object.keys(selectedData.pastTermGPA || {}).length;
      const gradeCount = Object.values(selectedData.pastGrades || {}).reduce((s,obj) => s + Object.keys(obj).length, 0);
      hasGrades = (gpaxCount+gradeCount) > 0;
    }

    btn.disabled = !(hasBasic && hasSelections && hasGrades);
  }

  // ========== ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î ==========

  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì GPAX ‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏ó‡∏≠‡∏°
  function calculateGPAFromTermGPA(termGPAObj){
    const vals = Object.values(termGPAObj || {}).filter(v => typeof v === 'number');
    if(vals.length === 0) return 0;
    const sum = vals.reduce((a,b)=>a+b,0);
    return sum / vals.length;
  }

  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì GPAX ‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤
  function calculateGPAXFromSubjectGrades(pastGrades){
    const terms = Object.keys(pastGrades || {});
    let total = 0, count = 0;
    terms.forEach(t=>{
      Object.values(pastGrades[t]).forEach(v => { if(typeof v === 'number'){ total += v; count++; }});
    });
    if(count === 0) return 0;
    return total / count;
  }

  // ========== ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ==========

  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ì‡∏∞/‡∏£‡∏≠‡∏ö/‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
  function calculateChance(currentGPAX, fieldId, round, university){
    const req = gradeRequirements[fieldId];
    if(!req) return 0;
    
    // ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ì‡∏∞
    let baseChance = (req.baseChance && req.baseChance[round]) ? req.baseChance[round] : 50;

    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥
    const gpaxRatio = (req.GPAX > 0) ? (currentGPAX / req.GPAX) : 1.0;
    let chanceMultiplier = 1.0;
    
    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏Å‡∏£‡∏î
    if (gpaxRatio >= 1.2) chanceMultiplier = 1.5;        // ‡πÄ‡∏Å‡∏£‡∏î‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å
    else if (gpaxRatio >= 1.1) chanceMultiplier = 1.3;   // ‡πÄ‡∏Å‡∏£‡∏î‡∏™‡∏π‡∏á
    else if (gpaxRatio >= 1.0) chanceMultiplier = 1.1;   // ‡πÄ‡∏Å‡∏£‡∏î‡∏û‡∏≠‡∏î‡∏µ‡πÄ‡∏Å‡∏ì‡∏ë‡πå
    else if (gpaxRatio >= 0.9) chanceMultiplier = 0.9;   // ‡πÄ‡∏Å‡∏£‡∏î‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢
    else if (gpaxRatio >= 0.8) chanceMultiplier = 0.7;   // ‡πÄ‡∏Å‡∏£‡∏î‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£
    else chanceMultiplier = 0.5;                          // ‡πÄ‡∏Å‡∏£‡∏î‡∏ï‡πà‡∏≥‡∏°‡∏≤‡∏Å

    // ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢
    const uniMultiplier = universityMultiplier[university] || 1.0;

    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≤‡∏£‡∏´‡∏±‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡πÄ‡∏Å‡∏ì‡∏ë‡πå
    let subjectPenalty = 1.0;
    let failedSubjects = 0;
    const grades = selectedData.pastGrades || {};
    
    for(const term in grades){
      const termGrades = grades[term];
      if(!termGrades) continue;
      for(const subj of (req.subjects || [])){
        const g = termGrades[subj];
        if(typeof g === 'number'){
          const minRequired = (typeof req.subMin === 'object') ? (req.subMin[subj] || req.subMin) : req.subMin;
          if(minRequired !== undefined && g < minRequired) failedSubjects++;
        }
      }
    }
    if(failedSubjects > 0){
      subjectPenalty = Math.max(0.3, 1.0 - (failedSubjects * 0.12)); // ‡∏´‡∏±‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 12% ‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡πÄ‡∏Å‡∏ì‡∏ë‡πå
    }

    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
    let finalChance = baseChance * chanceMultiplier * uniMultiplier * subjectPenalty;
    finalChance = Math.round(finalChance);
    finalChance = clamp(finalChance, 5, 95); // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÑ‡∏ß‡πâ 5-95%
    return finalChance;
  }

  // ========== ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ==========

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
  function renderResults(){
    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì GPAX ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    const gpaxFromTerm = calculateGPAFromTermGPA(selectedData.pastTermGPA);
    const gpaxFromSubjects = calculateGPAXFromSubjectGrades(selectedData.pastGrades);
    // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì: ‡∏ñ‡πâ‡∏≤‡∏Å‡∏£‡∏≠‡∏Å GPA ‡∏£‡∏≤‡∏¢‡πÄ‡∏ó‡∏≠‡∏°‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤
    const currentGPAX = (Object.keys(selectedData.pastTermGPA||{}).length>0) ? gpaxFromTerm : gpaxFromSubjects;

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
    const summaryHtml = `
      <div class="result-card">
        <h3>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h3>
        <p><strong>‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏ß‡∏° (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì):</strong> ${currentGPAX ? currentGPAX.toFixed(2) : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</p>
        <p><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</strong> ${selectedData.level}</p>
        <p><strong>‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</strong> ${plans[selectedData.plan] || '-'}</p>
        <p><strong>‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</strong> ${selectedData.rounds.map(r => ({portfolio:'Portfolio', quota:'‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤', admission:'Admission'}[r]||r)).join(', ')}</p>
      </div>
    `;
    el.resultContent.innerHTML = summaryHtml;

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    selectedData.fields.forEach(fieldId => {
      const fieldName = (fieldOptions[selectedData.plan] || []).find(f => f.id === fieldId)?.name || fieldId;
      const req = gradeRequirements[fieldId];
      const gpaxMinTxt = req ? req.GPAX.toFixed(2) : '-';

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ì‡∏∞
      const fieldCard = document.createElement('div');
      fieldCard.className = 'result-card fade-in';
      fieldCard.innerHTML = `<h3>üéØ ${fieldName}</h3>
        <p><strong>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ GPAX:</strong> ${gpaxMinTxt}</p>`;

      // ‡∏ß‡∏ô‡∏ã‡πâ‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢
      selectedData.universities.forEach(uni => {
        const uniDiv = document.createElement('div');
        uniDiv.style.margin = '10px 0';
        uniDiv.innerHTML = `<h4 style="color:var(--accent); margin-bottom:8px;">üèõÔ∏è ${uni}</h4>`;
        
        // ‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö
        selectedData.rounds.forEach(round => {
          const ch = calculateChance(currentGPAX, fieldId, round, uni);
          const roundName = ({portfolio:'Portfolio', quota:'‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤', admission:'Admission'}[round] || round);
          const chanceClass = ch >= 70 ? 'high' : ch >= 40 ? 'mid' : 'low'; // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÇ‡∏≠‡∏Å‡∏≤‡∏™

          // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏≠‡∏Å‡∏≤‡∏™
          const row = document.createElement('div');
          row.className = 'chance-row';
          const left = document.createElement('div');
          left.style.minWidth = '110px';
          left.innerHTML = `<strong>${roundName}</strong><div class="small muted">${req ? '‡∏ï‡πâ‡∏≠‡∏á GPAX ' + req.GPAX : ''}</div>`;
          
          // ‡∏™‡∏£‡πâ‡∏≤‡∏á Progress Bar
          const barWrap = document.createElement('div'); barWrap.className = 'bar';
          const fill = document.createElement('div'); fill.className = 'fill ' + chanceClass;
          // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
          fill.style.width = '0%';
          setTimeout(()=> fill.style.width = ch + '%', 60);
          barWrap.appendChild(fill);
          
          const right = document.createElement('div'); right.style.minWidth = '56px';
          right.innerHTML = `<strong>${ch}%</strong>`;
          
          row.appendChild(left); row.appendChild(barWrap); row.appendChild(right);
          uniDiv.appendChild(row);
        });

        fieldCard.appendChild(uniDiv);
      });

      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏Å‡∏£‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥
      const minTableHtml = generateMinGradeTable(selectedData.level, fieldId);
      if(minTableHtml) {
        const mapDiv = document.createElement('div');
        mapDiv.innerHTML = minTableHtml;
        fieldCard.appendChild(mapDiv);
      }

      el.resultContent.appendChild(fieldCard);
    });

    // ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
    const adviceCard = document.createElement('div');
    adviceCard.className = 'result-card fade-in';
    adviceCard.innerHTML = `
      <h3>üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
      <ul style="padding-left:18px; line-height:1.9; color:#475569;">
        <li><strong style="color:var(--success)">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏™‡∏π‡∏á (70%+):</strong> ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</li>
        <li><strong style="color:var(--warn)">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (40-69%):</strong> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏£‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÅ‡∏ú‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á</li>
        <li><strong style="color:var(--danger)">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ï‡πà‡∏≥ (&lt;40%):</strong> ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°/‡∏û‡∏≠‡∏£‡πå‡∏ï</li>
        <li>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≠‡∏ö (Portfolio / Quota / Admission) ‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏≤‡∏¢‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏≠‡∏Å‡∏≤‡∏™</li>
      </ul>
      <div style="display:flex; gap:10px; margin-top:12px; justify-content:flex-end;">
        <a href="plan.html" class="btn secondary" id="goPlanBtn" title="‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô">‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (plan.html)</a>
        <button class="btn ghost" id="saveSnapshotBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå (‡∏ó‡∏î‡∏•‡∏≠‡∏á)</button>
      </div>
    `;
    el.resultContent.appendChild(adviceCard);

    // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û (‡πÉ‡∏ä‡πâ print dialog)
    const snapBtn = document.getElementById('saveSnapshotBtn');
    if(snapBtn){
      snapBtn.addEventListener('click', ()=>{
        // ‡πÄ‡∏õ‡∏¥‡∏î print dialog ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF ‡πÑ‡∏î‡πâ
        window.print();
      });
    }

    // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    el.resultsPanel.scrollIntoView({behavior:'smooth', block:'start'});
  }

  // ========== ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏Å‡∏£‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ==========

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏Å‡∏£‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏ô‡πÄ‡∏ó‡∏≠‡∏°‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤
  function generateMinGradeTable(selectedTerm, fieldId){
    // ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏ó‡∏≠‡∏°‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    const startIndex = levels.indexOf(selectedTerm);
    if(startIndex < 0) return '';
    const endIndex = levels.indexOf('‡∏°.6 ‡πÄ‡∏ó‡∏≠‡∏° 1');
    if(endIndex < 0 || startIndex > endIndex) return '';

    const req = gradeRequirements[fieldId];
    if(!req) return '';

    const subjects = req.subjects || [];
    const subMin = req.subMin;
    const totalTerms = endIndex + 1; // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ó‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ó‡∏≠‡∏°‡πÅ‡∏£‡∏Å

    // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÄ‡∏Å‡∏£‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
    const sumBySubject = {};
    let filledCount = 0;
    let gpaxSum = 0;
    let gpaxCount = 0;

    // ‡∏ô‡∏±‡∏ö‡πÄ‡∏Å‡∏£‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ó‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
    for(let i = 0; i < startIndex; i++){
      const term = levels[i];
      if(selectedData.pastGrades[term]){
        subjects.forEach(s=>{
          const g = selectedData.pastGrades[term][s];
          if(typeof g === 'number'){
            sumBySubject[s] = (sumBySubject[s] || 0) + g;
          }
        });
        filledCount++;
      }
      const gpa = selectedData.pastTermGPA[term];
      if(typeof gpa === 'number'){
        gpaxSum += gpa;
        gpaxCount++;
      }
    }

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    let html = `<div class="result-card"><h4>üìã ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏Å‡∏£‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ ‚Äî ${fieldOptions[selectedData.plan].find(f=>f.id===fieldId)?.name || fieldId}</h4>`;
    html += `<table class="grade-table"><thead><tr><th>‡πÄ‡∏ó‡∏≠‡∏°</th><th>‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</th>`;
    subjects.forEach(s => html += `<th>${s}</th>`);
    html += `</tr></thead><tbody>`;

    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏ó‡∏≠‡∏°‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤
    for(let i = startIndex; i <= endIndex; i++){
      const term = levels[i];
      const remTerms = totalTerms - gpaxCount;
      
      // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì GPA ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏ô‡πÄ‡∏ó‡∏≠‡∏°‡∏ô‡∏µ‡πâ
      let gpaNext = remTerms > 0 ? (req.GPAX * totalTerms - gpaxSum) / remTerms : req.GPAX;
      if(!isFinite(gpaNext)) gpaNext = req.GPAX;
      gpaNext = clamp(gpaNext, 0, 4);

      html += `<tr><td><strong>${term}</strong></td><td><strong>${gpaNext.toFixed(2)}</strong></td>`;
      
      // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥
      subjects.forEach(s => {
        const sumPrev = sumBySubject[s] || 0;
        const countPrev = filledCount;
        const remCount = totalTerms - countPrev;
        const target = (typeof subMin === 'object') ? (subMin[s] || subMin) : subMin;
        let gNext = remCount > 0 ? (target * totalTerms - sumPrev) / remCount : target;
        if(!isFinite(gNext)) gNext = target;
        gNext = clamp(gNext, 0, 4);
        html += `<td><strong>${gNext.toFixed(2)}</strong></td>`;
        sumBySubject[s] = sumPrev + gNext;
      });

      html += `</tr>`;
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ó‡∏≠‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
      gpaxSum += gpaNext;
      gpaxCount++;
      filledCount++;
    }

    html += `</tbody></table></div>`;
    return html;
  }

  // ========== ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ==========

  function init(){
    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
    el.planSelect.addEventListener('change', (e)=>{
      selectedData.plan = e.target.value;
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏ú‡∏ô
      selectedData.fields = [];
      renderFieldGrid();
      loadGradeForm();
      checkCalculateButton();
    });

    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
    el.levelSelect.addEventListener('change', (e)=>{
      selectedData.level = e.target.value;
      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏Å‡∏£‡∏î‡πÉ‡∏´‡∏°‡πà
      loadGradeForm();
      checkCalculateButton();
    });

    // ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£
    el.roundGrid.addEventListener('click', (ev)=>{
      const card = ev.target.closest('.card');
      if(!card) return;
      const round = card.dataset.round;
      card.classList.toggle('selected');
      if(card.classList.contains('selected')){
        if(!selectedData.rounds.includes(round)) selectedData.rounds.push(round);
      } else {
        selectedData.rounds = selectedData.rounds.filter(r => r !== round);
      }
      checkCalculateButton();
    });

    // ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
    el.calculateBtn.addEventListener('click', ()=>{
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
      if(selectedData.rounds.length === 0){
        showNotice('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£');
        return;
      }
      if(selectedData.fields.length === 0){
        showNotice('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à');
        return;
      }
      if(selectedData.universities.length === 0){
        showNotice('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢');
        return;
      }
      // ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
      renderResults();
    });

    // ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
    el.resetBtn.addEventListener('click', ()=>{
      if(!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) return;
      
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      selectedData = { level:'', plan:'', rounds:[], fields:[], universities:[], pastGrades:{}, pastTermGPA:{} };
      
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï UI
      el.levelSelect.value = '';
      el.planSelect.value = '';
      qsa('#roundGrid .card').forEach(c => c.classList.remove('selected'));
      renderFieldGrid();
      qsa('#universityGrid .card').forEach(c => c.classList.remove('selected'));
      renderUniversityGrid(); // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
      loadGradeForm();
      el.resultContent.innerHTML = '';
      el.resultSummary.innerHTML = `<h3>üìà ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì)</h3><p class="muted">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏î "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤" ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>`;
      checkCalculateButton();
    });

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á UI
    initSelectionGrids();
    loadGradeForm();
    checkCalculateButton();
  } 

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à
  init();

  // ‡πÄ‡∏õ‡∏¥‡∏î API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠ (‡∏ú‡πà‡∏≤‡∏ô window object)
  window._growAPlus = {
    state: selectedData,
    calculateChance,
    renderResults
  };
  </script>
</body>
</html>